unit OpenTest;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  Db, DBTables, DBCtrls, Grids, DBGrids, StdCtrls, Buttons, ExtCtrls;

type
  TOpenForm = class(TForm)
    Panel1: TPanel;
    BitBtn1: TBitBtn;
    BitBtn2: TBitBtn;
    DBGrid1: TDBGrid;
    Panel2: TPanel;
    DBNavigator1: TDBNavigator;
    DS: TDataSource;
    TestTable: TTable;
    OD: TOpenDialog;
    TestTableFILE_NAME: TStringField;
    TestTableFULL_NAME: TStringField;
    TestTableSUBJECT: TStringField;
    TestTableTDL_TEXT: TMemoField;
    TestTableCODE_PAGE: TStringField;
    Edit1: TEdit;
    procedure BitBtn2Click(Sender: TObject);
    procedure BitBtn1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure Edit1Change(Sender: TObject);
  public

  end;

var
  OpenForm: TOpenForm;

implementation
uses Manager , Message;
{$R *.DFM}

procedure TOpenForm.BitBtn2Click(Sender: TObject);
begin
  MainF.FileOpen:=false;
  Close;
end;

procedure TOpenForm.BitBtn1Click(Sender: TObject);
begin
    MainF.Memo.Lines.Text:=TestTable.FieldByName('TDL_Text').AsString;
    MainF.FileName:=TestTable.FieldByName('File_Name').AsString;
    MainF.FileOpen:=true;
    Close;
end;
procedure TOpenForm.FormCreate(Sender: TObject);
begin
  TestTable.Active:=true;
  Top:=MainF.Top+((MainF.Height-Height) div 2);
  Left:=MainF.Left+((MainF.Width-Width) div 2);
  Caption:=Mess[MainF.CurLang,61];
  BitBtn1.Caption:=Mess[MainF.CurLang,65];
  BitBtn2.Caption:=Mess[MainF.CurLang,66];
  TestTableFILE_NAME.DisplayLabel:=Mess[MainF.CurLang,62];
  TestTableFULL_NAME.DisplayLabel:=Mess[MainF.CurLang,63];
  TestTableSUBJECT.DisplayLabel:=Mess[MainF.CurLang,64];
end;

procedure TOpenForm.Edit1Change(Sender: TObject);
begin
   if  Edit1.Text <>'' then
         TestTable.Filter:='FILE_NAME='+''''+Edit1.Text+'*'''
   else  TestTable.Filter:='';
end;

end.
